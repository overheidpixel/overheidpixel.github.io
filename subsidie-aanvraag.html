<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subsidie Aanvraag Formulier</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <h1>Subsidie Aanvraag Formulier</h1>

    <form id="subsidieForm">
        <!-- Formulier wordt dynamisch gevuld met JS -->
    </form>

    <button id="submitBtn">Download aanvraag als PDF</button>

    <script>
        const { jsPDF } = window.jspdf;

        // Hier kun je makkelijk vragen toevoegen of wijzigen
        const vragen = [
            { label: "Bedrijfsnaam", type: "text", name: "bedrijf", required: true },
            { label: "Eigenaar", type: "text", name: "eigenaar", required: true },
            { label: "Bankafschriften (upload foto)", type: "file", name: "bankafschriften", accept: "image/*", required: true },
            { label: "Financieel dashboard (bossmenu screenshot)", type: "file", name: "dashboard", accept: "image/*", required: true },
            { label: "Omschrijf je aanvraag", type: "textarea", name: "omschrijving", required: true }
        ];

        const form = document.getElementById('subsidieForm');

        vragen.forEach(vraag => {
            const label = document.createElement('label');
            label.textContent = vraag.label;
            form.appendChild(label);

            let input;
            if(vraag.type === "textarea") {
                input = document.createElement('textarea');
                input.rows = 5;
            } else {
                input = document.createElement('input');
                input.type = vraag.type;
                if(vraag.accept) input.accept = vraag.accept;
            }
            input.name = vraag.name;
            if(vraag.required) input.required = true;

            form.appendChild(input);
        });

        document.getElementById('submitBtn').addEventListener('click', function() {
            const formData = new FormData(form);
            const doc = new jsPDF();

            doc.setFontSize(16);
            doc.text("Subsidie Aanvraag", 105, 20, null, null, 'center');

            let y = 40;
            vragen.forEach(vraag => {
                const value = formData.get(vraag.name);
                if(vraag.type !== "file") {
                    doc.setFontSize(12);
                    doc.text(`${vraag.label}: ${value}`, 20, y);
                    y += 10;
                }
            });

            // Voeg afbeeldingen toe
            const bankafschriften = formData.get('bankafschriften');
            const dashboard = formData.get('dashboard');

            if(bankafschriften && dashboard) {
                const reader1 = new FileReader();
                reader1.onload = function(e1) {
                    doc.addImage(e1.target.result, 'JPEG', 20, y, 80, 60);

                    const reader2 = new FileReader();
                    reader2.onload = function(e2) {
                        doc.addImage(e2.target.result, 'JPEG', 110, y, 80, 60);
                        doc.save(`${formData.get('bedrijf')}_subsidie_aanvraag.pdf`);
                    };
                    reader2.readAsDataURL(dashboard);
                };
                reader1.readAsDataURL(bankafschriften);
            }
        });
    </script>
</body>
</html>
